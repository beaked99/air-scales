{% extends 'base.html.twig' %}

{% block title %}Hello DashboardController!{% endblock %}

{% block body %}
<h1>Your Devices</h1>

{% if devices is empty %}
  <p>No devices associated with your account yet.</p>
{% else %}
  <ul>
    {% for device in devices %}
      <li>
        Device #{{ device.id }} (MAC: {{ device.macAddress }})<br>
        {% set access = null %}
        {% for record in accessRecords %}
          {% if record.device.id == device.id %}
            {% set access = record %}
          {% endif %}
        {% endfor %}
        {% if access %}
          First seen: {{ access.firstSeenAt|date('Y-m-d H:i') }}<br>
          Last connected: {{ access.lastConnectedAt|date('Y-m-d H:i') }}<br>
        {% else %}
          <em>You have not connected to this device yet.</em><br>
        {% endif %}

        {% if not access %}
          <a href="{{ path('unlink_device', { id: device.id }) }}">Unlink</a>
        {% endif %}
      </li>
    {% endfor %}
  </ul>
{% endif %}



{% endblock %}
